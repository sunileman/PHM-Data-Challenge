{"paragraphs":[{"text":"%sh\n/bin/hdfs dfs -ls s3a://sunileman1/phm_data_challenge/","user":"admin","dateUpdated":"2018-10-09T13:38:14+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"18/10/09 13:38:17 INFO impl.MetricsConfig: loaded properties from hadoop-metrics2.properties\n18/10/09 13:38:17 INFO impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).\n18/10/09 13:38:17 INFO impl.MetricsSystemImpl: s3a-file-system metrics system started\nFound 3 items\ndrwxrwxrwx   - zeppelin zeppelin          0 2018-10-09 13:38 s3a://sunileman1/phm_data_challenge/faults\n-rw-rw-rw-   1 zeppelin zeppelin 5357121884 2018-09-22 03:30 s3a://sunileman1/phm_data_challenge/phm_data_challenge_2018.tar.gz\ndrwxrwxrwx   - zeppelin zeppelin          0 2018-10-09 13:38 s3a://sunileman1/phm_data_challenge/tsdata\n18/10/09 13:38:20 INFO impl.MetricsSystemImpl: Stopping s3a-file-system metrics system...\n18/10/09 13:38:20 INFO impl.MetricsSystemImpl: s3a-file-system metrics system stopped.\n18/10/09 13:38:20 INFO impl.MetricsSystemImpl: s3a-file-system metrics system shutdown complete.\n"}]},"apps":[],"jobName":"paragraph_1539091948683_-191990692","id":"20181005-215802_1501887843","dateCreated":"2018-10-09T13:32:28+0000","dateStarted":"2018-10-09T13:38:14+0000","dateFinished":"2018-10-09T13:38:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:42539"},{"text":"%spark2.spark\nval sensorDF = spark.read.format(\"csv\").option(\"header\", \"true\").option(\"mode\", \"DROPMALFORMED\").option(\"inferSchema\", \"true\").option(\"delimiter\", \",\").load(\"s3a://sunileman1/phm_data_challenge/tsdata/\")\nval faultDF = spark.read.format(\"csv\").option(\"header\", \"true\").option(\"mode\", \"DROPMALFORMED\").option(\"inferSchema\", \"true\").option(\"delimiter\", \",\").load(\"s3a://sunileman1/phm_data_challenge/faults/\")","user":"admin","dateUpdated":"2018-10-09T13:45:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"sensorDF: org.apache.spark.sql.DataFrame = [time: int, Tool: string ... 22 more fields]\nfaultDF: org.apache.spark.sql.DataFrame = [time: int, fault_name: string ... 1 more field]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-24-149.ec2.internal:4040/jobs/job?id=0","http://ip-172-31-24-149.ec2.internal:4040/jobs/job?id=1","http://ip-172-31-24-149.ec2.internal:4040/jobs/job?id=2","http://ip-172-31-24-149.ec2.internal:4040/jobs/job?id=3"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1539091948688_-180635863","id":"20180922-031011_595974663","dateCreated":"2018-10-09T13:32:28+0000","dateStarted":"2018-10-09T13:45:14+0000","dateFinished":"2018-10-09T13:49:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:42540"},{"title":"Cache dataframes","text":"%spark2.spark\n//sensorDF.persist(MEMORY_AND_DISK_SER)\n//faultDF.persist(sensorDF)","user":"admin","dateUpdated":"2018-10-09T13:54:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1539093215593_1319737690","id":"20181009-135335_1730149614","dateCreated":"2018-10-09T13:53:35+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:42541"},{"text":"%spark2.spark\n\nsensorDF.registerTempTable(\"sensorDF\")\n\nspark.sql(\"SELECT Tool, stage, Lot, runnum, recipe, time FROM sensorDF where Tool = '05M01' order by time ASC\").limit(100).show","user":"admin","dateUpdated":"2018-10-09T13:50:16+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n+-----+-----+----+--------+------+-------+\n| Tool|stage| Lot|  runnum|recipe|   time|\n+-----+-----+----+--------+------+-------+\n|05M01|  165|9396|10511360|   133|3280856|\n|05M01|  165|9396|10511360|   133|3280860|\n|05M01|  165|9396|10511360|   133|3280864|\n|05M01|  165|9396|10511360|   133|3280868|\n|05M01|  165|9396|10511360|   133|3280872|\n|05M01|  165|9396|10511360|   133|3280876|\n|05M01|  165|9396|10511360|   133|3280880|\n|05M01|  165|9396|10511360|   133|3280884|\n|05M01|  165|9396|10511360|   133|3280888|\n|05M01|  165|9396|10511360|   133|3280892|\n|05M01|  165|9396|10511360|   133|3280896|\n|05M01|  165|9396|10511360|   133|3280900|\n|05M01|  165|9396|10511360|   133|3280904|\n|05M01|  165|9396|10511360|   133|3280908|\n|05M01|  165|9396|10511360|   133|3280912|\n|05M01|  165|9396|10511360|   133|3280916|\n|05M01|  165|9396|10511360|   133|3280920|\n|05M01|  165|9396|10511360|   133|3280924|\n|05M01|  165|9396|10511360|   133|3280928|\n|05M01|  165|9396|10511360|   133|3280932|\n+-----+-----+----+--------+------+-------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-24-149.ec2.internal:4040/jobs/job?id=5"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1539091948689_-461753686","id":"20180929-025706_1477969167","dateCreated":"2018-10-09T13:32:28+0000","dateStarted":"2018-10-09T13:50:16+0000","dateFinished":"2018-10-09T13:51:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:42542"},{"text":"%spark2.spark\nsensorDF.printSchema\nfaultDF.printSchema\n","user":"admin","dateUpdated":"2018-10-09T13:32:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- time: integer (nullable = true)\n |-- Tool: string (nullable = true)\n |-- stage: integer (nullable = true)\n |-- Lot: integer (nullable = true)\n |-- runnum: integer (nullable = true)\n |-- recipe: integer (nullable = true)\n |-- recipe_step: double (nullable = true)\n |-- IONGAUGEPRESSURE: double (nullable = true)\n |-- ETCHBEAMVOLTAGE: double (nullable = true)\n |-- ETCHBEAMCURRENT: double (nullable = true)\n |-- ETCHSUPPRESSORVOLTAGE: double (nullable = true)\n |-- ETCHSUPPRESSORCURRENT: double (nullable = true)\n |-- FLOWCOOLFLOWRATE: double (nullable = true)\n |-- FLOWCOOLPRESSURE: double (nullable = true)\n |-- ETCHGASCHANNEL1READBACK: double (nullable = true)\n |-- ETCHPBNGASREADBACK: double (nullable = true)\n |-- FIXTURETILTANGLE: double (nullable = true)\n |-- ROTATIONSPEED: double (nullable = true)\n |-- ACTUALROTATIONANGLE: double (nullable = true)\n |-- FIXTURESHUTTERPOSITION: double (nullable = true)\n |-- ETCHSOURCEUSAGE: double (nullable = true)\n |-- ETCHAUXSOURCETIMER: double (nullable = true)\n |-- ETCHAUX2SOURCETIMER: double (nullable = true)\n |-- ACTUALSTEPDURATION: double (nullable = true)\n\nroot\n |-- time: integer (nullable = true)\n |-- fault_name: string (nullable = true)\n |-- Tool: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1539091948690_1026401851","id":"20180922-031018_1688945769","dateCreated":"2018-10-09T13:32:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:42543"},{"title":"Inner join on tool and time","text":"%spark2.spark\n\nval matchedDF = sensorDF.join(faultDF, sensorDF(\"Tool\") === faultDF(\"Tool\") && sensorDF(\"time\") === faultDF(\"time\") , joinType=\"inner\").drop(faultDF(\"Tool\")).drop(faultDF(\"time\"))\n\nmatchedDF.limit(10).show\n\n","user":"admin","dateUpdated":"2018-10-09T13:54:40+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"matchedDF: org.apache.spark.sql.DataFrame = [time: int, Tool: string ... 23 more fields]\n+--------+-----+-----+-----+--------+------+-----------+--------------------+-------------------+-------------------+---------------------+---------------------+-------------------+-------------------+-----------------------+-------------------+--------------------+--------------------+--------------------+----------------------+-------------------+-------------------+-------------------+--------------------+--------------------+\n|    time| Tool|stage|  Lot|  runnum|recipe|recipe_step|    IONGAUGEPRESSURE|    ETCHBEAMVOLTAGE|    ETCHBEAMCURRENT|ETCHSUPPRESSORVOLTAGE|ETCHSUPPRESSORCURRENT|   FLOWCOOLFLOWRATE|   FLOWCOOLPRESSURE|ETCHGASCHANNEL1READBACK| ETCHPBNGASREADBACK|    FIXTURETILTANGLE|       ROTATIONSPEED| ACTUALROTATIONANGLE|FIXTURESHUTTERPOSITION|    ETCHSOURCEUSAGE| ETCHAUXSOURCETIMER|ETCHAUX2SOURCETIMER|  ACTUALSTEPDURATION|          fault_name|\n+--------+-----+-----+-----+--------+------+-----------+--------------------+-------------------+-------------------+---------------------+---------------------+-------------------+-------------------+-----------------------+-------------------+--------------------+--------------------+--------------------+----------------------+-------------------+-------------------+-------------------+--------------------+--------------------+\n| 9557348|02M01|  159| 2150|10905971|     5|        3.0| -0.1592307021501567| 0.6989065535647491| 0.7342090516602912|    0.661782258434466|   0.7470728840422478| 0.5764750169090579|0.03431201410016014|      0.625612867655491| 0.6237022443120177| 0.09681567452282712| -0.4736149591500446| -0.0961957587114026|                   1.0|  -1.19709858969842|-1.4906437338953102|-1.3518168332105647| -0.2572268625082514|FlowCool Pressure...|\n|24694404|07M01|  199|17334|11868896|   299|        1.0| -1.7236646547957326|-1.4726001926705172|-1.4457257612985908|  -1.5429874115621747|  -1.4747107656092344| 0.5287883113085774|0.30459065103845717|    -1.6620252298130973|-1.6467573360286654|  1.6349035074205887|-0.05248566244088155|-0.13348971558259784|                   0.0|-0.6709463886803467| -1.092062210667407|-0.7667288116884204| -0.6360165560366499|Flowcool Pressure...|\n|34955722|08M01|  375| 4694|12553778|   481|        5.0| -0.9919596032840791|-1.1779434519848357|-1.2557743707331863|  -1.4764122035618958|  -0.9162500070211508|-2.0808602801146203|-1.0259515894316962|     -1.203075953325415|-1.7467842698384757|   1.842230700128303| -0.5115606099154307|-0.08616047282119375|                   0.0|-0.2954664193711041| 1.0865811988918161| 1.3827621326512973| -0.6113858575893364|FlowCool Pressure...|\n| 4279600|09M01|   63| 4068|10570842|     2|        4.0|  -1.556390640545394|-1.2617911070689447|-1.2693180966273918|  -1.3786202544615198|   -1.302473115880426| -1.687052438047825|-1.2860737757802638|     -1.532893446752998|-1.8053380905322114|   1.393146882951545|-0.06194010887218249| -0.1563081484844333|                   0.0|  1.540324876549752| 0.8964704948585445|  2.169382363863989| -0.7552796777775486|FlowCool Pressure...|\n| 5478756|09M01|  175| 9445|10649513|   300|        1.0|  0.8246341669835493| 1.0214069896776965|0.44500616008800065|   0.3358562250270427|    0.719261388601655| 0.6011171308530774|0.28409170379908794|     0.7891382412828986| 0.6404593235380949| -0.4782917471009925|-0.06194010887218249| -0.1563081484844333|                   0.0|-1.3250881518554452| 1.2022565217263554|-1.1493010093370342|-0.13628253947027413|FlowCool Pressure...|\n| 5478756|09M01|  175| 9445|10649513|   300|        1.0|  0.8246341669835493| 1.0214069896776965|0.44500616008800065|   0.3358562250270427|    0.719261388601655| 0.6011171308530774|0.28409170379908794|     0.7891382412828986| 0.6404593235380949| -0.4782917471009925|-0.06194010887218249| -0.1563081484844333|                   0.0|-1.3250881518554452| 1.2022565217263554|-1.1493010093370342|-0.13628253947027413|FlowCool Pressure...|\n|35337042|01M02|    1| 9614|12579070|    67|       33.0|-0.07161466366787346|-0.9593263057158641|-0.9595803079068432|  -0.9451856660671808|  -0.9390426794102577| -2.841849516088073|-2.3328068957350747|    -1.7504101432154815|-2.7924498287263373|  1.3592755697687453|-0.01320718744649...|  1.1653004399120006|                   0.0| 0.6253203028710816| 0.8820563130800965| 1.1076546897933435| 0.02104416822151068|FlowCool Pressure...|\n|35339442|01M02|    1| 9614|12579070|    67|       35.0|-0.07943548705132286|-0.9589850595615739|-0.9599349870116914|  -0.9460567672604933|  -0.9390426794102577| -2.841849516088073|-2.3328068957350747|    -1.7516611485587419|-2.7924498287263373|  1.3592755697687453|-0.01320718744649...|  1.1642132085474273|                   0.0| 0.6253203028710816| 0.8820563130800965| 1.1076546897933435| 0.02104416822151068|       Flowcool leak|\n|35479998|01M02|    1| 9690|12588681|    67|       29.0|-0.07874996930376475|-0.9590419351089956|-0.9596512376809438|   -0.946148462426951|  -0.9390426794102577| -2.841849516088073|-2.3328068957350747|    -1.7504101432154815|-2.7912231783713115|0.022130759153434307|-0.01320718744649...|  1.6481485532306144|                   0.0| 0.6838494328713987| 0.9475598900056258|  1.175753830074194| -0.3154230571350515|       Flowcool leak|\n|35667758|01M02|    1| 9614|12599802|    67|       45.0|-0.07708680522729083|-0.9593263057158641|-0.9590128697140383|  -0.9452773612336386|  -0.9390426794102577| -2.842906518897486|-2.2378733856517297|    -1.7471575247996358|-2.7924498287263373|0.022130759153434307|-0.01320718744649...|   9.483461655608556|                   0.0| 0.7478347806463117| 1.0191469885302642| 1.2501775500226606|  0.8035260876553761|FlowCool Pressure...|\n+--------+-----+-----+-----+--------+------+-----------+--------------------+-------------------+-------------------+---------------------+---------------------+-------------------+-------------------+-----------------------+-------------------+--------------------+--------------------+--------------------+----------------------+-------------------+-------------------+-------------------+--------------------+--------------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-24-149.ec2.internal:4040/jobs/job?id=6","http://ip-172-31-24-149.ec2.internal:4040/jobs/job?id=7"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1539091948691_-1730983821","id":"20180925-205222_2051661619","dateCreated":"2018-10-09T13:32:28+0000","dateStarted":"2018-10-09T13:54:40+0000","dateFinished":"2018-10-09T14:00:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:42544"},{"text":"%spark2.spark\nval dfDummy = sensorDF.withColumn(\"fault_name\",lit(null: String))\n","user":"admin","dateUpdated":"2018-10-09T14:03:34+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"dfDummy: org.apache.spark.sql.DataFrame = [time: int, Tool: string ... 23 more fields]\n"}]},"apps":[],"jobName":"paragraph_1539091948691_242265686","id":"20181002-171823_727271580","dateCreated":"2018-10-09T13:32:28+0000","dateStarted":"2018-10-09T14:03:34+0000","dateFinished":"2018-10-09T14:03:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:42545"},{"title":"Create DF of unmatch sensor readings","text":"%spark2.spark\nval unmatchSensorDF = dfDummy.select(\"*\").except( matchedDF.select(\"*\"))\n","user":"admin","dateUpdated":"2018-10-09T14:03:37+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"unmatchSensorDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [time: int, Tool: string ... 23 more fields]\n"}]},"apps":[],"jobName":"paragraph_1539091948692_1865279710","id":"20180929-030624_1309093783","dateCreated":"2018-10-09T13:32:28+0000","dateStarted":"2018-10-09T14:03:37+0000","dateFinished":"2018-10-09T14:03:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:42546"},{"text":"%spark2.spark\nmatchedDF.createOrReplaceTempView(\"matchedDF\")\n\nspark.sql(\"SELECT Tool, stage, Lot, runnum, recipe, time FROM matchedDF where Tool = '05M01' order by time ASC\").limit(100).show","user":"admin","dateUpdated":"2018-10-09T14:03:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+-----+-----+--------+------+--------+\n| Tool|stage|  Lot|  runnum|recipe|    time|\n+-----+-----+-----+--------+------+--------+\n|05M01|  178|16924|10557275|   300| 4047836|\n|05M01|  180| 1473|10575230|   300| 4316884|\n|05M01|  180|10658|10575230|   300| 4320124|\n|05M01|  178|11873|10684973|   300| 6197356|\n|05M01|  305| 1161|11197237|     8|13915168|\n|05M01|  139| 1259|11861319|     0|24586892|\n|05M01|    1| 8186|12676861|     1|37409908|\n|05M01|    1| 8186|12676861|     1|37416000|\n+-----+-----+-----+--------+------+--------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-24-149.ec2.internal:4040/jobs/job?id=8","http://ip-172-31-24-149.ec2.internal:4040/jobs/job?id=9"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1539091948692_-1392439759","id":"20180929-030017_1854051417","dateCreated":"2018-10-09T13:32:28+0000","dateStarted":"2018-10-09T14:03:45+0000","dateFinished":"2018-10-09T14:05:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:42547"},{"text":"%spark2.spark\nmatchedDF.printSchema","user":"admin","dateUpdated":"2018-10-09T13:32:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- time: integer (nullable = true)\n |-- Tool: string (nullable = true)\n |-- stage: integer (nullable = true)\n |-- Lot: integer (nullable = true)\n |-- runnum: integer (nullable = true)\n |-- recipe: integer (nullable = true)\n |-- recipe_step: double (nullable = true)\n |-- IONGAUGEPRESSURE: double (nullable = true)\n |-- ETCHBEAMVOLTAGE: double (nullable = true)\n |-- ETCHBEAMCURRENT: double (nullable = true)\n |-- ETCHSUPPRESSORVOLTAGE: double (nullable = true)\n |-- ETCHSUPPRESSORCURRENT: double (nullable = true)\n |-- FLOWCOOLFLOWRATE: double (nullable = true)\n |-- FLOWCOOLPRESSURE: double (nullable = true)\n |-- ETCHGASCHANNEL1READBACK: double (nullable = true)\n |-- ETCHPBNGASREADBACK: double (nullable = true)\n |-- FIXTURETILTANGLE: double (nullable = true)\n |-- ROTATIONSPEED: double (nullable = true)\n |-- ACTUALROTATIONANGLE: double (nullable = true)\n |-- FIXTURESHUTTERPOSITION: double (nullable = true)\n |-- ETCHSOURCEUSAGE: double (nullable = true)\n |-- ETCHAUXSOURCETIMER: double (nullable = true)\n |-- ETCHAUX2SOURCETIMER: double (nullable = true)\n |-- ACTUALSTEPDURATION: double (nullable = true)\n |-- fault_name: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1539091948693_-1233223384","id":"20180926-162119_1053410898","dateCreated":"2018-10-09T13:32:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:42548"},{"text":"%spark2.spark\n//1000 unmatched records\nval unmatchFaultsMinus = faultDF.select(\"time\", \"Tool\").except( sensorDF.select(\"time\", \"Tool\"))\n\nval unmatchFaultsDF = unmatchFaultsMinus.join(faultDF, unmatchFaultsMinus(\"Tool\") === faultDF(\"Tool\") && unmatchFaultsMinus(\"time\") === faultDF(\"time\") , joinType=\"inner\").drop(faultDF(\"Tool\")).drop(faultDF(\"time\")).distinct\n//unmatchFaultsDF.limit(10).show\n\n//unmatchFaultsDF.count\n\n//drop(up_ddf.name)\n\n","user":"admin","dateUpdated":"2018-10-09T14:06:03+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"unmatchFaultsMinus: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [time: int, Tool: string]\nunmatchFaultsDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [time: int, fault_name: string ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1539091948693_-1451635478","id":"20180925-204146_164085449","dateCreated":"2018-10-09T13:32:28+0000","dateStarted":"2018-10-09T14:06:03+0000","dateFinished":"2018-10-09T14:06:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:42549"},{"title":"Create a Windowed DF to fill in the gaps for unmatched faults","text":"%spark2.spark\nimport org.apache.spark.sql.expressions.Window\nval w = Window.partitionBy(\"Tool\").orderBy(\"time\")\n\nval lagCol = lag(col(\"time\"), 1).over(w)\n\nval leadCol = lead(col(\"time\"), 1).over(w)\nval sendorDFWindowed = unmatchSensorDF.withColumn(\"previous_value\", lagCol).withColumn(\"next_value\", leadCol).na.fill(1)\n\nsendorDFWindowed.printSchema\n\nsendorDFWindowed.limit(10).show()\n\n//faultDF.withColumn(\"LagCol\", lagCol).show()","user":"admin","dateUpdated":"2018-10-09T14:06:12+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.expressions.Window\nw: org.apache.spark.sql.expressions.WindowSpec = org.apache.spark.sql.expressions.WindowSpec@6fa222dc\nlagCol: org.apache.spark.sql.Column = lag(time, 1, NULL) OVER (PARTITION BY Tool ORDER BY time ASC NULLS FIRST unspecifiedframe$())\nleadCol: org.apache.spark.sql.Column = lead(time, 1, NULL) OVER (PARTITION BY Tool ORDER BY time ASC NULLS FIRST unspecifiedframe$())\nsendorDFWindowed: org.apache.spark.sql.DataFrame = [time: int, Tool: string ... 25 more fields]\nroot\n |-- time: integer (nullable = false)\n |-- Tool: string (nullable = true)\n |-- stage: integer (nullable = false)\n |-- Lot: integer (nullable = false)\n |-- runnum: integer (nullable = false)\n |-- recipe: integer (nullable = false)\n |-- recipe_step: double (nullable = false)\n |-- IONGAUGEPRESSURE: double (nullable = false)\n |-- ETCHBEAMVOLTAGE: double (nullable = false)\n |-- ETCHBEAMCURRENT: double (nullable = false)\n |-- ETCHSUPPRESSORVOLTAGE: double (nullable = false)\n |-- ETCHSUPPRESSORCURRENT: double (nullable = false)\n |-- FLOWCOOLFLOWRATE: double (nullable = false)\n |-- FLOWCOOLPRESSURE: double (nullable = false)\n |-- ETCHGASCHANNEL1READBACK: double (nullable = false)\n |-- ETCHPBNGASREADBACK: double (nullable = false)\n |-- FIXTURETILTANGLE: double (nullable = false)\n |-- ROTATIONSPEED: double (nullable = false)\n |-- ACTUALROTATIONANGLE: double (nullable = false)\n |-- FIXTURESHUTTERPOSITION: double (nullable = false)\n |-- ETCHSOURCEUSAGE: double (nullable = false)\n |-- ETCHAUXSOURCETIMER: double (nullable = false)\n |-- ETCHAUX2SOURCETIMER: double (nullable = false)\n |-- ACTUALSTEPDURATION: double (nullable = false)\n |-- fault_name: string (nullable = true)\n |-- previous_value: integer (nullable = false)\n |-- next_value: integer (nullable = false)\n\n+-------+-----+-----+---+--------+------+-----------+--------------------+-------------------+-------------------+---------------------+---------------------+-------------------+--------------------+-----------------------+-------------------+-----------------+--------------------+-------------------+----------------------+--------------------+-------------------+-------------------+--------------------+----------+--------------+----------+\n|   time| Tool|stage|Lot|  runnum|recipe|recipe_step|    IONGAUGEPRESSURE|    ETCHBEAMVOLTAGE|    ETCHBEAMCURRENT|ETCHSUPPRESSORVOLTAGE|ETCHSUPPRESSORCURRENT|   FLOWCOOLFLOWRATE|    FLOWCOOLPRESSURE|ETCHGASCHANNEL1READBACK| ETCHPBNGASREADBACK| FIXTURETILTANGLE|       ROTATIONSPEED|ACTUALROTATIONANGLE|FIXTURESHUTTERPOSITION|     ETCHSOURCEUSAGE| ETCHAUXSOURCETIMER|ETCHAUX2SOURCETIMER|  ACTUALSTEPDURATION|fault_name|previous_value|next_value|\n+-------+-----+-----+---+--------+------+-----------+--------------------+-------------------+-------------------+---------------------+---------------------+-------------------+--------------------+-----------------------+-------------------+-----------------+--------------------+-------------------+----------------------+--------------------+-------------------+-------------------+--------------------+----------+--------------+----------+\n|3283106|01M01|    1|589|10511625|     1|        5.0|  0.7452345970405204| 1.0850426929308457|-1.1518416260130435|  0.49668109733139576|  -1.0860370538281434|-1.4446948713638752|-0.21934944964227598|     0.7446379615135028| 0.7271473935589372|1.170894098797054|-0.20389165787325159|-0.1524952203343316|                   0.0|-0.07173262788930664|-0.2577978546128085| 0.8627806659088515|-0.20058688458701812|      null|             1|   3283110|\n|3283110|01M01|    1|589|10511625|     1|        5.0|-0.03702427603670149|-0.9322860768688878|-1.1521118758780862|  -0.9281124678156932|  -1.1457896827297107|-1.4446948713638752| -0.5471569717145119|    -1.3121427309627238|-1.4053846913993169|1.170894098797054|-0.20389165787325159|-0.1524952203343316|                   0.0|-0.07173262788930664|-0.2577978546128085| 0.8627806659088515|-0.20058688458701812|      null|       3283106|   3283114|\n|3283114|01M01|    1|589|10511625|     1|        5.0|  -0.507875381516016|-1.1066101824425276|-1.1519091877593368|  -1.1245616111579089|  -1.1457896827297107|-1.4446948713638752| -0.6387806065661203|    -1.3121427309627238|-1.4053846913993169|1.170894098797054|-0.20389165787325159|-0.1524952203343316|                   0.0|-0.07173262788930664|-0.2577978546128085| 0.8627806659088515|-0.20058688458701812|      null|       3283110|   3283118|\n|3283118|01M01|    1|589|10511625|     1|        5.0| -0.7938934199264659| -1.128402399220907|  -1.15197674950563|  -1.1745031607042635|  -1.1457896827297107|-1.4446948713638752| -0.6823513711304482|    -1.3121427309627238|-1.4053846913993169|1.170894098797054|-0.20389165787325159|-0.1524952203343316|                   0.0|-0.07173262788930664|-0.2577978546128085| 0.8627806659088515|-0.20058688458701812|      null|       3283114|   3283122|\n|3283122|01M01|    1|589|10511625|     1|        5.0| -0.9777174164092678| -1.128402399220907|-1.1517064996405872|  -1.1840622317127112|  -1.1457896827297107|-1.4446948713638752| -0.7373255520414131|    -1.3121427309627238|-1.4053846913993169|1.170894098797054|-0.20389165787325159|-0.1524952203343316|                   0.0|-0.07173262788930664|-0.2577978546128085| 0.8627806659088515|-0.20058688458701812|      null|       3283118|   3283126|\n|3283126|01M01|    1|589|10511625|     1|        5.0|  -1.065632418399891| -1.128402399220907|-1.1520443141317929|   -1.186256932631817|  -1.1457896827297107|-1.4446948713638752| -0.7580934869839667|    -1.3121427309627238|-1.4053846913993169|1.170894098797054|-0.20389165787325159|-0.1524952203343316|                   0.0|-0.07173262788930664|-0.2577978546128085| 0.8627806659088515|-0.20058688458701812|      null|       3283122|   3283130|\n|3283130|01M01|    1|589|10511625|     1|        5.0| -1.1321801506625668| -1.128402399220907|-1.1518416260130435|  -1.1874762044554092|  -1.1457896827297107|-1.4446948713638752| -0.7756042560826001|    -1.3121427309627238|-1.4053846913993169|1.170894098797054|-0.20389165787325159|-0.1524952203343316|                   0.0|-0.07173262788930664|-0.2577978546128085| 0.8627806659088515|-0.20058688458701812|      null|       3283126|   3283134|\n|3283134|01M01|    1|589|10511625|     1|        5.0| -1.1779011607426773| -1.128402399220907|-1.1521794376243795|  -1.1877200594325825|  -1.1457896827297107|-1.4446948713638752| -0.8024795437771495|    -1.3121427309627238|-1.4053846913993169|1.170894098797054|-0.20389165787325159|-0.1524952203343316|                   0.0|-0.07173262788930664|-0.2577978546128085| 0.8627806659088515|-0.20058688458701812|      null|       3283130|   3283138|\n|3283138|01M01|    1|589|10511625|     1|        5.0| -1.2067822596075073| -1.128402399220907|-1.1516389378942942|  -1.1877688292031074|  -1.1457896827297107|-1.4446948713638752| -0.8130676678949317|    -1.3121427309627238|-1.4053846913993169|1.170894098797054|-0.20389165787325159|-0.1524952203343316|                   0.0|-0.07173262788930664|-0.2577978546128085| 0.8627806659088515|-0.20058688458701812|      null|       3283134|   3283142|\n|3283142|01M01|    1|589|10511625|     1|        5.0| -1.2384068373332184| -1.128402399220907|  -1.15197674950563|   -1.188061453950806|  -1.1457896827297107|-1.4446948713638752| -0.8212112496833154|    -1.3121427309627238|-1.4053846913993169|1.170894098797054|-0.20389165787325159|-0.1524952203343316|                   0.0|-0.07173262788930664|-0.2577978546128085| 0.8627806659088515|-0.20058688458701812|      null|       3283138|   3283146|\n+-------+-----+-----+---+--------+------+-----------+--------------------+-------------------+-------------------+---------------------+---------------------+-------------------+--------------------+-----------------------+-------------------+-----------------+--------------------+-------------------+----------------------+--------------------+-------------------+-------------------+--------------------+----------+--------------+----------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-24-149.ec2.internal:4040/jobs/job?id=10","http://ip-172-31-24-149.ec2.internal:4040/jobs/job?id=11"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1539091948694_-145704270","id":"20180925-212708_806856326","dateCreated":"2018-10-09T13:32:28+0000","dateStarted":"2018-10-09T14:06:12+0000","dateFinished":"2018-10-09T14:10:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:42550"},{"text":"%spark2.spark\n//sendorDFWindowed.cache.createOrReplaceTempView(\"sendorWindowed\")\n//sendorDFWindowed.collect()\nsendorDFWindowed.createOrReplaceTempView(\"sendorDFWindowed\")\n","user":"admin","dateUpdated":"2018-10-09T14:45:34+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1539091948694_2146885419","id":"20181002-180740_540518084","dateCreated":"2018-10-09T13:32:28+0000","dateStarted":"2018-10-09T14:45:34+0000","dateFinished":"2018-10-09T14:45:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:42551"},{"text":"%spark2.spark\n//unmatchFaultsDF.cache.createOrReplaceTempView(\"unmatchFaults\")\n//unmatchFaultsDF.collect()\nunmatchFaultsDF.createOrReplaceTempView(\"unmatchFaultsDF\")\n","user":"admin","dateUpdated":"2018-10-09T14:45:36+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1539091948695_632559888","id":"20181002-180815_2055479268","dateCreated":"2018-10-09T13:32:28+0000","dateStarted":"2018-10-09T14:45:36+0000","dateFinished":"2018-10-09T14:45:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:42552"},{"text":"%spark2.spark\nsendorDFWindowed.printSchema","user":"admin","dateUpdated":"2018-10-09T15:25:19+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- time: integer (nullable = false)\n |-- Tool: string (nullable = true)\n |-- stage: integer (nullable = false)\n |-- Lot: integer (nullable = false)\n |-- runnum: integer (nullable = false)\n |-- recipe: integer (nullable = false)\n |-- recipe_step: double (nullable = false)\n |-- IONGAUGEPRESSURE: double (nullable = false)\n |-- ETCHBEAMVOLTAGE: double (nullable = false)\n |-- ETCHBEAMCURRENT: double (nullable = false)\n |-- ETCHSUPPRESSORVOLTAGE: double (nullable = false)\n |-- ETCHSUPPRESSORCURRENT: double (nullable = false)\n |-- FLOWCOOLFLOWRATE: double (nullable = false)\n |-- FLOWCOOLPRESSURE: double (nullable = false)\n |-- ETCHGASCHANNEL1READBACK: double (nullable = false)\n |-- ETCHPBNGASREADBACK: double (nullable = false)\n |-- FIXTURETILTANGLE: double (nullable = false)\n |-- ROTATIONSPEED: double (nullable = false)\n |-- ACTUALROTATIONANGLE: double (nullable = false)\n |-- FIXTURESHUTTERPOSITION: double (nullable = false)\n |-- ETCHSOURCEUSAGE: double (nullable = false)\n |-- ETCHAUXSOURCETIMER: double (nullable = false)\n |-- ETCHAUX2SOURCETIMER: double (nullable = false)\n |-- ACTUALSTEPDURATION: double (nullable = false)\n |-- fault_name: string (nullable = true)\n |-- previous_value: integer (nullable = false)\n |-- next_value: integer (nullable = false)\n\n"}]},"apps":[],"jobName":"paragraph_1539098712946_-221263244","id":"20181009-152512_1621546136","dateCreated":"2018-10-09T15:25:12+0000","dateStarted":"2018-10-09T15:25:19+0000","dateFinished":"2018-10-09T15:25:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:42553"},{"text":"%spark2.spark\n\nval gapFilledDF = sendorDFWindowed.join(unmatchFaultsDF, sendorDFWindowed(\"Tool\") === unmatchFaultsDF(\"Tool\") && sendorDFWindowed(\"time\") < unmatchFaultsDF(\"time\")  && sendorDFWindowed(\"next_value\") > unmatchFaultsDF(\"time\") , joinType=\"left_outer\").drop(sendorDFWindowed(\"previous_value\")).drop(sendorDFWindowed(\"next_value\")).drop(unmatchFaultsDF(\"time\")).drop(unmatchFaultsDF(\"Tool\")).drop(unmatchFaultsDF(\"time\")).drop(sendorDFWindowed(\"fault_name\"))\n\ngapFilledDF.limit(10).show()\n","user":"admin","dateUpdated":"2018-10-09T15:25:26+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"gapFilledDF: org.apache.spark.sql.DataFrame = [time: int, Tool: string ... 23 more fields]\n+-------+-----+-----+-----+--------+------+-----------+-------------------+--------------------+-------------------+---------------------+---------------------+-------------------+-------------------+-----------------------+-------------------+-----------------+--------------------+-------------------+----------------------+------------------+------------------+-------------------+--------------------+----------+\n|   time| Tool|stage|  Lot|  runnum|recipe|recipe_step|   IONGAUGEPRESSURE|     ETCHBEAMVOLTAGE|    ETCHBEAMCURRENT|ETCHSUPPRESSORVOLTAGE|ETCHSUPPRESSORCURRENT|   FLOWCOOLFLOWRATE|   FLOWCOOLPRESSURE|ETCHGASCHANNEL1READBACK| ETCHPBNGASREADBACK| FIXTURETILTANGLE|       ROTATIONSPEED|ACTUALROTATIONANGLE|FIXTURESHUTTERPOSITION|   ETCHSOURCEUSAGE|ETCHAUXSOURCETIMER|ETCHAUX2SOURCETIMER|  ACTUALSTEPDURATION|fault_name|\n+-------+-----+-----+-----+--------+------+-----------+-------------------+--------------------+-------------------+---------------------+---------------------+-------------------+-------------------+-----------------------+-------------------+-----------------+--------------------+-------------------+----------------------+------------------+------------------+-------------------+--------------------+----------+\n|3283190|09M01|   17|19384|10511547|     3|        5.0|0.42813238222234556|-0.28463095224741297| -1.272731814249075|   1.2735040173615348|   -1.182078975638019|0.34471075022641173|  0.191666516109929|     0.2913798268820641| 0.6422182034161911|1.393146882951545|-0.06194010887218249|-0.1563081484844333|                   0.0|1.0281975059172586|0.6399705258983462|  1.533610273995345|-0.20260366143176783|      null|\n|3283194|09M01|   17|19384|10511547|     3|        5.0|0.02945818223988615|  -1.045904138656285|-1.2734285047770835| -0.43477356145335655|  -1.3085394718687384|-1.6580253103594258|-0.6112654517673797|     -1.444729364637841|-1.5971561504842764|1.393146882951545|-0.06194010887218249|-0.1563081484844333|                   0.0|1.0281975059172586|0.6399705258983462|  1.533610273995345|-0.20260366143176783|      null|\n|3283198|09M01|   17|19384|10511547|     3|        5.0|-0.6726820202520638| -1.2431533935506454|-1.2735678422937071|  -1.1538195489174494|   -1.314839147328637|-1.6580253103594258|-0.7157181026047389|    -1.4603414407919164|-1.5971561504842764|1.393146882951545|-0.06194010887218249|-0.1563081484844333|                   0.0|1.0281975059172586|0.6399705258983462|  1.533610273995345|-0.20260366143176783|      null|\n|3283202|09M01|   17|19384|10511547|     3|        5.0|-1.0142421038153782|  -1.262645339428442|-1.2729408131617828|  -1.3153268812606285|  -1.3146058278570512|-1.6580253103594258|-0.7638107185833444|    -1.4603414407919164|-1.5971561504842764|1.393146882951545|-0.06194010887218249|-0.1563081484844333|                   0.0|1.0281975059172586|0.6399705258983462|  1.533610273995345|-0.20260366143176783|      null|\n|3283206|09M01|   17|19384|10511547|     3|        5.0|-1.1418835003581644| -1.2647420903919113|-1.2735678422937071|  -1.3560012819773335|  -1.3118059941980218|-1.6580253103594258|-0.7964999574049092|    -1.5268321490892056|-1.5971561504842764|1.393146882951545|-0.06194010887218249|-0.1563081484844333|                   0.0|1.0281975059172586|0.6399705258983462|  1.533610273995345|-0.20260366143176783|      null|\n|3283210|09M01|   17|19384|10511547|     3|        5.0|-1.2614437523237618|  -1.264276147553954|-1.2733588374912173|   -1.367955607840048|  -1.3146058278570512|-1.6580253103594258|-0.8445925733835147|    -1.5268321490892056|-1.5971561504842764|1.393146882951545|-0.06194010887218249|-0.1563081484844333|                   0.0|1.0281975059172586|0.6399705258983462|  1.533610273995345|-0.20260366143176783|      null|\n|3283214|09M01|   17|19384|10511547|     3|        5.0|-1.3150838047330045| -1.2639655211800251|-1.2739858489537954|  -1.3735111607104722|  -1.3132059110275365|-1.6580253103594258|  -0.86488253066495|    -1.5268321490892056|-1.5971561504842764|1.393146882951545|-0.06194010887218249|-0.1563081484844333|                   0.0|1.0281975059172586|0.6399705258983462|  1.533610273995345|-0.20260366143176783|      null|\n|3283218|09M01|   17|19384|10511547|     3|        5.0|-1.3739790615876981|   -1.26489740685594|-1.2740555191845528|  -1.3752472553776955|  -1.3122726331411936|-1.6580253103594258| -0.883292465812359|    -1.5316077126689212|-1.5971561504842764|1.393146882951545|-0.06194010887218249|-0.1563081484844333|                   0.0|1.0281975059172586|0.6399705258983462|  1.533610273995345|-0.20260366143176783|      null|\n|3283222|09M01|   17|19384|10511547|     3|        5.0| -1.405029596384098| -1.2646644337984292|-1.2731498326887276|   -1.376388121154393|  -1.3129725915559507|-1.6580253103594258|-0.8979460502519003|    -1.5316077126689212|-1.5971561504842764|1.393146882951545|-0.06194010887218249|-0.1563081484844333|                   0.0|1.0281975059172586|0.6399705258983462|  1.533610273995345|-0.20260366143176783|      null|\n|3283226|09M01|   17|19384|10511547|     3|        5.0|-1.4291176004078452| -1.2643538074245004|-1.2732194999745938|   -1.377380179708459|  -1.3150724668002227|-1.6580253103594258|-0.9257499401357991|     -1.532893446752998|-1.5971561504842764|1.393146882951545|-0.06194010887218249|-0.1563081484844333|                   0.0|1.0281975059172586|0.6399705258983462|  1.533610273995345|-0.20260366143176783|      null|\n+-------+-----+-----+-----+--------+------+-----------+-------------------+--------------------+-------------------+---------------------+---------------------+-------------------+-------------------+-----------------------+-------------------+-----------------+--------------------+-------------------+----------------------+------------------+------------------+-------------------+--------------------+----------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-24-149.ec2.internal:4040/jobs/job?id=18","http://ip-172-31-24-149.ec2.internal:4040/jobs/job?id=19","http://ip-172-31-24-149.ec2.internal:4040/jobs/job?id=20"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1539091948695_1341348460","id":"20180925-213741_719469771","dateCreated":"2018-10-09T13:32:28+0000","dateStarted":"2018-10-09T15:25:26+0000","dateFinished":"2018-10-09T15:33:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:42554"},{"text":"%spark2.spark\ngapFilledDF.printSchema","user":"admin","dateUpdated":"2018-10-09T15:24:26+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- time: integer (nullable = false)\n |-- Tool: string (nullable = true)\n |-- stage: integer (nullable = false)\n |-- Lot: integer (nullable = false)\n |-- runnum: integer (nullable = false)\n |-- recipe: integer (nullable = false)\n |-- recipe_step: double (nullable = false)\n |-- IONGAUGEPRESSURE: double (nullable = false)\n |-- ETCHBEAMVOLTAGE: double (nullable = false)\n |-- ETCHBEAMCURRENT: double (nullable = false)\n |-- ETCHSUPPRESSORVOLTAGE: double (nullable = false)\n |-- ETCHSUPPRESSORCURRENT: double (nullable = false)\n |-- FLOWCOOLFLOWRATE: double (nullable = false)\n |-- FLOWCOOLPRESSURE: double (nullable = false)\n |-- ETCHGASCHANNEL1READBACK: double (nullable = false)\n |-- ETCHPBNGASREADBACK: double (nullable = false)\n |-- FIXTURETILTANGLE: double (nullable = false)\n |-- ROTATIONSPEED: double (nullable = false)\n |-- ACTUALROTATIONANGLE: double (nullable = false)\n |-- FIXTURESHUTTERPOSITION: double (nullable = false)\n |-- ETCHSOURCEUSAGE: double (nullable = false)\n |-- ETCHAUXSOURCETIMER: double (nullable = false)\n |-- ETCHAUX2SOURCETIMER: double (nullable = false)\n |-- ACTUALSTEPDURATION: double (nullable = false)\n |-- fault_name: string (nullable = true)\n |-- fault_name: string (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1539098638913_1976654760","id":"20181009-152358_1475819701","dateCreated":"2018-10-09T15:23:58+0000","dateStarted":"2018-10-09T15:24:26+0000","dateFinished":"2018-10-09T15:24:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:42555"},{"title":"Merge matched and unmatched","text":"%spark2.spark\n\n//matchedDF.printSchema\n//gapFilledDF.printSchema\nval completeDF = matchedDF.union(gapFilledDF)","user":"admin","dateUpdated":"2018-10-09T15:49:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"completeDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [time: int, Tool: string ... 23 more fields]\n"}]},"apps":[],"jobName":"paragraph_1539091948695_-252639061","id":"20180925-212653_1752335893","dateCreated":"2018-10-09T13:32:28+0000","dateStarted":"2018-10-09T15:49:14+0000","dateFinished":"2018-10-09T15:49:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:42556"},{"text":"%spark2.spark\nunmatchSensorDF.createOrReplaceTempView(\"unmatchSensorDF\")\ncompleteDFWindowed.createOrReplaceTempView(\"completeDF\")\nmatchedDF.createOrReplaceTempView(\"matchedDF\")\ngapFilledDF.createOrReplaceTempView(\"gapFilledDF\")\n\n\n\n","user":"admin","dateUpdated":"2018-10-10T02:28:58+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1539116006459_1046959175","id":"20181009-201326_1520791594","dateCreated":"2018-10-09T20:13:26+0000","dateStarted":"2018-10-10T02:28:58+0000","dateFinished":"2018-10-10T02:28:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:42557"},{"text":"%spark2.spark\nval sqlDF = spark.sql(\"SELECT * FROM unmatchSensorDF where Tool = '05M01' and time = 4047836\")\nsqlDF.limit(10).show","user":"admin","dateUpdated":"2018-10-10T02:29:06+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"msg":[{"data":"","type":"TEXT"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-24-149.ec2.internal:4040/jobs/job?id=39","http://ip-172-31-24-149.ec2.internal:4040/jobs/job?id=40"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1539116067404_-1560554695","id":"20181009-201427_26796037","dateCreated":"2018-10-09T20:14:27+0000","dateStarted":"2018-10-10T02:29:06+0000","dateFinished":"2018-10-09T20:43:56+0000","status":"RUNNING","progressUpdateIntervalMs":500,"$$hashKey":"object:42558","errorMessage":""},{"text":"%spark2.spark\nval w1 = Window.partitionBy(\"Tool\", \"stage\", \"Lot\", \"runnum\", \"recipe\").orderBy(\"time\")\nval w2 = Window.partitionBy(\"Tool\", \"stage\", \"Lot\", \"runnum\").orderBy(\"time\")\nval w3 = Window.partitionBy(\"Tool\", \"stage\", \"Lot\").orderBy(\"time\")\nval w4 = Window.partitionBy(\"Tool\", \"stage\").orderBy(\"time\")\nval w5 = Window.partitionBy(\"Tool\").orderBy(\"time\")\n\n\n\n\nval lagCol = lag(col(\"time\"), 1).over(w)\n\nval w1_firstValue = first(\"time\").over(w1)\nval w2_firstValue = first(\"time\").over(w2)\nval w3_firstValue = first(\"time\").over(w3)\nval w4_firstValue = first(\"time\").over(w4)\nval w5_firstValue = first(\"time\").over(w5)\n\nval leadCol = lead(col(\"time\"), 1).over(w)\n//val completeDFWindowed = completeDF.withColumn(\"firstValue\", firstCol).withColumn(\"previous_value\", lagCol).withColumn(\"next_value\", leadCol).na.fill(0)\n\n//completeDF.printSchema\n\nval completeDFWindowed = completeDF.withColumn(\"w1_firstValue\", w1_firstValue).withColumn(\"w2_firstValue\", w2_firstValue).withColumn(\"w3_firstValue\", w3_firstValue).withColumn(\"w4_firstValue\", w4_firstValue).withColumn(\"w5_firstValue\", w5_firstValue)\n\n//val completeDFWindowed = completeDF.select(col(\"*\"), first(\"time\").over(w).alias(\"fv\"))\n\n//completeDF.select('*',\n//   F.first(\"time\",True).over(w).alias('first_w1')\n//).show()\n\ncompleteDFWindowed.createOrReplaceTempView(\"windowedDF\")\n\ncompleteDFWindowed.cache()\ncompleteDFWindowed.limit(10).show\n\n\n","user":"admin","dateUpdated":"2018-10-09T18:34:17+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"w1: org.apache.spark.sql.expressions.WindowSpec = org.apache.spark.sql.expressions.WindowSpec@5b0a11d1\nw2: org.apache.spark.sql.expressions.WindowSpec = org.apache.spark.sql.expressions.WindowSpec@33a23fcf\nw3: org.apache.spark.sql.expressions.WindowSpec = org.apache.spark.sql.expressions.WindowSpec@39b00fbe\nw4: org.apache.spark.sql.expressions.WindowSpec = org.apache.spark.sql.expressions.WindowSpec@6328cb8c\nw5: org.apache.spark.sql.expressions.WindowSpec = org.apache.spark.sql.expressions.WindowSpec@1d9daaad\nlagCol: org.apache.spark.sql.Column = lag(time, 1, NULL) OVER (PARTITION BY Tool ORDER BY time ASC NULLS FIRST unspecifiedframe$())\nw1_firstValue: org.apache.spark.sql.Column = first(time, false) OVER (PARTITION BY Tool, stage, Lot, runnum, recipe ORDER BY time ASC NULLS FIRST unspecifiedframe$())\nw2_firstValue: org.apache.spark.sql.Column = first(time, false) OVER (PARTITION BY Tool, stage, Lot, runnum ORDER BY time ASC NULLS FIRST unspecifiedframe$())\nw3_firstValue: org.apache.spark.sql.Column = first(time, false) OVER (PARTITION BY Tool, stage, Lot ORDER BY time ASC NULLS FIRST unspecifiedframe$())\nw4_firstValue: org.apache.spark.sql.Column = first(time, false) OVER (PARTITION BY Tool, stage ORDER BY time ASC NULLS FIRST unspecifiedframe$())\nw5_firstValue: org.apache.spark.sql.Column = first(time, false) OVER (PARTITION BY Tool ORDER BY time ASC NULLS FIRST unspecifiedframe$())\nleadCol: org.apache.spark.sql.Column = lead(time, 1, NULL) OVER (PARTITION BY Tool ORDER BY time ASC NULLS FIRST unspecifiedframe$())\ncompleteDFWindowed: org.apache.spark.sql.DataFrame = [time: int, Tool: string ... 28 more fields]\nres58: completeDFWindowed.type = [time: int, Tool: string ... 28 more fields]\n+-------+-----+-----+----+--------+------+-----------+-------------------+-------------------+-------------------+---------------------+---------------------+-------------------+--------------------+-----------------------+-------------------+------------------+--------------------+--------------------+----------------------+-------------------+------------------+-------------------+------------------+----------+-------------+-------------+-------------+-------------+-------------+\n|   time| Tool|stage| Lot|  runnum|recipe|recipe_step|   IONGAUGEPRESSURE|    ETCHBEAMVOLTAGE|    ETCHBEAMCURRENT|ETCHSUPPRESSORVOLTAGE|ETCHSUPPRESSORCURRENT|   FLOWCOOLFLOWRATE|    FLOWCOOLPRESSURE|ETCHGASCHANNEL1READBACK| ETCHPBNGASREADBACK|  FIXTURETILTANGLE|       ROTATIONSPEED| ACTUALROTATIONANGLE|FIXTURESHUTTERPOSITION|    ETCHSOURCEUSAGE|ETCHAUXSOURCETIMER|ETCHAUX2SOURCETIMER|ACTUALSTEPDURATION|fault_name|w1_firstValue|w2_firstValue|w3_firstValue|w4_firstValue|w5_firstValue|\n+-------+-----+-----+----+--------+------+-----------+-------------------+-------------------+-------------------+---------------------+---------------------+-------------------+--------------------+-----------------------+-------------------+------------------+--------------------+--------------------+----------------------+-------------------+------------------+-------------------+------------------+----------+-------------+-------------+-------------+-------------+-------------+\n|3280856|05M01|  165|9396|10511360|   133|        5.0|-0.5673895942209246|-1.4061704581045595| -1.468724570172921|   -1.569929434458033|  -1.5147820740719202|-1.9084993419951417|-0.00322263725899...|    -1.6841911360824418|-1.6872061798298106|-0.662925326668638|-0.06587464746978587|-0.25431690597315915|                   0.0|-0.8372801604524873|1.7068385522217737|-0.5701169715885237|-0.546321066491288|      null|      3280856|      3280856|      3280856|      3280856|      3280856|\n|3280860|05M01|  165|9396|10511360|   133|        5.0|-1.0129159517852688|-1.4861964172444189|-1.4686540978703468|   -1.569929434458033|  -1.5147820740719202|-1.9084993419951417|-0.00545088215403...|    -1.6841911360824418|-1.6872061798298106|-0.662925326668638|-0.06587464746978587|-0.25431690597315915|                   0.0|-0.8372801604524873|1.7068385522217737|-0.5701169715885237|-0.546321066491288|      null|      3280856|      3280856|      3280856|      3280856|      3280856|\n|3280864|05M01|  165|9396|10511360|   133|        5.0|-1.2225742215527469|-1.4888436661763098|-1.4685836255677727|   -1.569929434458033|  -1.5147820740719202|-1.9084993419951417|-0.00767730211467...|    -1.6841911360824418|-1.6872061798298106|-0.662925326668638|-0.06587464746978587|-0.25431690597315915|                   0.0|-0.8372801604524873|1.7068385522217737|-0.5701169715885237|-0.546321066491288|      null|      3280856|      3280856|      3280856|      3280856|      3280856|\n|3280868|05M01|  165|9396|10511360|   133|        5.0| -1.380129136956484|-1.4888436661763098|-1.4683722086600497|   -1.569929434458033|  -1.5147820740719202|-1.9084993419951417|-0.00990554700972...|    -1.6841911360824418|-1.6872061798298106|-0.662925326668638|-0.06587464746978587|-0.25431690597315915|                   0.0|-0.8372801604524873|1.7068385522217737|-0.5701169715885237|-0.546321066491288|      null|      3280856|      3280856|      3280856|      3280856|      3280856|\n|3280872|05M01|  165|9396|10511360|   133|        5.0| -1.476403460223514|-1.4888436661763098|-1.4683017363574755|   -1.569929434458033|  -1.5147820740719202|-1.9084993419951417|-0.01213379190476181|    -1.6841911360824418|-1.6872061798298106|-0.662925326668638|-0.06587464746978587|-0.25431690597315915|                   0.0|-0.8372801604524873|1.7068385522217737|-0.5701169715885237|-0.546321066491288|      null|      3280856|      3280856|      3280856|      3280856|      3280856|\n|3280876|05M01|  165|9396|10511360|   133|        5.0|-1.5290091145228015|-1.4888436661763098| -1.468442680962624|   -1.569929434458033|  -1.5147820740719202|-1.9084993419951417|-0.01436021186540...|    -1.6841911360824418|-1.6872061798298106|-0.662925326668638|-0.06587464746978587|-0.25431690597315915|                   0.0|-0.8372801604524873|1.7068385522217737|-0.5701169715885237|-0.546321066491288|      null|      3280856|      3280856|      3280856|      3280856|      3280856|\n|3280880|05M01|  165|9396|10511360|   133|        5.0|-1.5728911722623555|-1.4888436661763098|-1.4686540978703468|   -1.569929434458033|  -1.5147820740719202|-1.9084993419951417|-0.01436021186540...|    -1.6841911360824418|-1.6872061798298106|-0.662925326668638|-0.06587464746978587|-0.25431690597315915|                   0.0|-0.8372801604524873|1.7068385522217737|-0.5701169715885237|-0.546321066491288|      null|      3280856|      3280856|      3280856|      3280856|      3280856|\n|3280884|05M01|  165|9396|10511360|   133|        5.0|-1.6056876579632178|-1.4888436661763098|-1.4683017363574755|   -1.569929434458033|  -1.5147820740719202|-1.9084993419951417|-0.01658845676044...|    -1.6841911360824418|-1.6872061798298106|-0.662925326668638|-0.06587464746978587|-0.25431690597315915|                   0.0|-0.8372801604524873|1.7068385522217737|-0.5701169715885237|-0.546321066491288|      null|      3280856|      3280856|      3280856|      3280856|      3280856|\n|3280888|05M01|  165|9396|10511360|   133|        5.0|-1.6356649789400526|-1.4888436661763098|-1.4685836255677727|   -1.569929434458033|  -1.5147820740719202|-1.9084993419951417|-0.01881670165549...|    -1.6841911360824418|-1.6872061798298106|-0.662925326668638|-0.06587464746978587|-0.25431690597315915|                   0.0|-0.8372801604524873|1.7068385522217737|-0.5701169715885237|-0.546321066491288|      null|      3280856|      3280856|      3280856|      3280856|      3280856|\n|3280892|05M01|  165|9396|10511360|   133|        5.0|-1.6571822714363513|-1.4888436661763098|-1.4691474039883665|   -1.569929434458033|  -1.5147820740719202|-1.9084993419951417|-0.02104494655053...|    -1.6841911360824418|-1.6872061798298106|-0.662925326668638|-0.06587464746978587|-0.25431690597315915|                   0.0|-0.8372801604524873|1.7068385522217737|-0.5701169715885237|-0.546321066491288|      null|      3280856|      3280856|      3280856|      3280856|      3280856|\n+-------+-----+-----+----+--------+------+-----------+-------------------+-------------------+-------------------+---------------------+---------------------+-------------------+--------------------+-----------------------+-------------------+------------------+--------------------+--------------------+----------------------+-------------------+------------------+-------------------+------------------+----------+-------------+-------------+-------------+-------------+-------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-24-149.ec2.internal:4040/jobs/job?id=21","http://ip-172-31-24-149.ec2.internal:4040/jobs/job?id=22","http://ip-172-31-24-149.ec2.internal:4040/jobs/job?id=23","http://ip-172-31-24-149.ec2.internal:4040/jobs/job?id=24"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1539091948696_-270979948","id":"20180925-212652_1877814839","dateCreated":"2018-10-09T13:32:28+0000","dateStarted":"2018-10-09T18:34:17+0000","dateFinished":"2018-10-09T18:49:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:42559"},{"text":"%spark2.spark\n","user":"admin","dateUpdated":"2018-10-09T20:14:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1539116034159_345992306","id":"20181009-201354_2004267558","dateCreated":"2018-10-09T20:13:54+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:42560"},{"text":"%spark2.spark\n//completeDFWindowed.cache()\n\n//completeDFWindowed.cache.createOrReplaceTempView(\"windowedDF\")\n//completeDFWindowed.collect()\n\nuncacheTable(\"windowedDF\")","user":"admin","dateUpdated":"2018-10-09T13:32:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1539091948696_-1775887191","id":"20180929-023921_1849614341","dateCreated":"2018-10-09T13:32:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:42561"},{"text":"%spark2.spark\nval sqlDF = spark.sql(\"SELECT * FROM windowedDF where Tool = '05M01' and time = 4047836\")\nsqlDF.limit(10).show\n","user":"admin","dateUpdated":"2018-10-09T20:11:04+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"sqlDF: org.apache.spark.sql.DataFrame = [time: int, Tool: string ... 28 more fields]\n+-------+-----+-----+-----+--------+------+-----------+------------------+-----------------+------------------+---------------------+---------------------+------------------+------------------+-----------------------+------------------+--------------------+--------------------+--------------------+----------------------+-------------------+-------------------+-------------------+-------------------+-------------+-------------+-------------+-------------+-------------+-------------+\n|   time| Tool|stage|  Lot|  runnum|recipe|recipe_step|  IONGAUGEPRESSURE|  ETCHBEAMVOLTAGE|   ETCHBEAMCURRENT|ETCHSUPPRESSORVOLTAGE|ETCHSUPPRESSORCURRENT|  FLOWCOOLFLOWRATE|  FLOWCOOLPRESSURE|ETCHGASCHANNEL1READBACK|ETCHPBNGASREADBACK|    FIXTURETILTANGLE|       ROTATIONSPEED| ACTUALROTATIONANGLE|FIXTURESHUTTERPOSITION|    ETCHSOURCEUSAGE| ETCHAUXSOURCETIMER|ETCHAUX2SOURCETIMER| ACTUALSTEPDURATION|   fault_name|w1_firstValue|w2_firstValue|w3_firstValue|w4_firstValue|w5_firstValue|\n+-------+-----+-----+-----+--------+------+-----------+------------------+-----------------+------------------+---------------------+---------------------+------------------+------------------+-----------------------+------------------+--------------------+--------------------+--------------------+----------------------+-------------------+-------------------+-------------------+-------------------+-------------+-------------+-------------+-------------+-------------+-------------+\n|4047836|05M01|  178|16924|10557275|   300|        3.0|0.6972708731696532|0.824858013114585|0.8515994528125025|  0.34885900742247283|   0.7807350110100719|0.5205164694829848|0.3554371939916799|     0.6568676009953004|0.5767846623409699|-0.10099168632198431|-0.06587464746978587|-0.25431690597315915|                   1.0|-1.1175231673045716|-1.4805491815033196|-0.8312072567384291|-0.8308777887809792|         null|      4047452|      4047452|      4047452|      3522826|      3280856|\n|4047836|05M01|  178|16924|10557275|   300|        3.0|0.6972708731696532|0.824858013114585|0.8515994528125025|  0.34885900742247283|   0.7807350110100719|0.5205164694829848|0.3554371939916799|     0.6568676009953004|0.5767846623409699|-0.10099168632198431|-0.06587464746978587|-0.25431690597315915|                   1.0|-1.1175231673045716|-1.4805491815033196|-0.8312072567384291|-0.8308777887809792|Flowcool leak|      4047452|      4047452|      4047452|      3522826|      3280856|\n+-------+-----+-----+-----+--------+------+-----------+------------------+-----------------+------------------+---------------------+---------------------+------------------+------------------+-----------------------+------------------+--------------------+--------------------+--------------------+----------------------+-------------------+-------------------+-------------------+-------------------+-------------+-------------+-------------+-------------+-------------+-------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-24-149.ec2.internal:4040/jobs/job?id=25"],"interpreterSettingId":"spark2"}},"apps":[],"jobName":"paragraph_1539091948697_830459511","id":"20180928-171417_763210210","dateCreated":"2018-10-09T13:32:28+0000","dateStarted":"2018-10-09T20:11:04+0000","dateFinished":"2018-10-09T20:11:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:42562"},{"text":"%spark2.spark\nspark.sql(\"SELECT Tool, stage, Lot, runnum, recipe, time, firstValue FROM windowedDF where Tool = '05M01' and stage = 165 order by time ASC\").limit(100).show\n","user":"admin","dateUpdated":"2018-10-09T13:32:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----+---+------+------+----+----------+\n|Tool|stage|Lot|runnum|recipe|time|firstValue|\n+----+-----+---+------+------+----+----------+\n+----+-----+---+------+------+----+----------+\n\n"}]},"apps":[],"jobName":"paragraph_1539091948697_-1099608111","id":"20180928-170703_1606385935","dateCreated":"2018-10-09T13:32:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:42563"},{"text":"%spark2.spark\ncompleteDFWindowed.printSchema","user":"admin","dateUpdated":"2018-10-09T13:32:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- time: integer (nullable = false)\n |-- Tool: string (nullable = true)\n |-- stage: integer (nullable = false)\n |-- Lot: integer (nullable = false)\n |-- runnum: integer (nullable = false)\n |-- recipe: integer (nullable = false)\n |-- recipe_step: double (nullable = false)\n |-- IONGAUGEPRESSURE: double (nullable = false)\n |-- ETCHBEAMVOLTAGE: double (nullable = false)\n |-- ETCHBEAMCURRENT: double (nullable = false)\n |-- ETCHSUPPRESSORVOLTAGE: double (nullable = false)\n |-- ETCHSUPPRESSORCURRENT: double (nullable = false)\n |-- FLOWCOOLFLOWRATE: double (nullable = false)\n |-- FLOWCOOLPRESSURE: double (nullable = false)\n |-- ETCHGASCHANNEL1READBACK: double (nullable = false)\n |-- ETCHPBNGASREADBACK: double (nullable = false)\n |-- FIXTURETILTANGLE: double (nullable = false)\n |-- ROTATIONSPEED: double (nullable = false)\n |-- ACTUALROTATIONANGLE: double (nullable = false)\n |-- FIXTURESHUTTERPOSITION: double (nullable = false)\n |-- ETCHSOURCEUSAGE: double (nullable = false)\n |-- ETCHAUXSOURCETIMER: double (nullable = false)\n |-- ETCHAUX2SOURCETIMER: double (nullable = false)\n |-- ACTUALSTEPDURATION: double (nullable = false)\n |-- fault_name: string (nullable = true)\n |-- previous_value: integer (nullable = false)\n |-- next_value: integer (nullable = false)\n\n"}]},"apps":[],"jobName":"paragraph_1539091948697_616051809","id":"20180928-170613_928603690","dateCreated":"2018-10-09T13:32:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:42564"},{"text":"%spark2.spark\nval sqlDF = spark.sql(\"SELECT Tool, stage, Lot, runnum, recipe, CASE WHEN previous_value > 0 THEN time - previous_value END AS group_counts FROM windowedDF GROUP BY Tool, stage, Lot, runnum, recipe GROUPING SETS ((Tool, stage, Lot, runnum, recipe), (Tool, stage, Lot, runnum), (Tool, stage, Lot), (Tool, stage), (Tool)) ORDER BY Tool DESC NULLS LAST, stage ASC NULLS LAST, Lot ASC NULLS LAST, runnum ASC NULLS LAST, recipe ASC NULLS LAST\")","user":"admin","dateUpdated":"2018-10-09T13:32:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1539091948698_-1502377331","id":"20180925-212651_1727095989","dateCreated":"2018-10-09T13:32:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:42565"},{"text":"%spark2.spark\nval sqlDF = spark.sql(\"SELECT Tool, stage, Lot, runnum, recipe, time, previous_value, next_value, CASE WHEN previous_value > 0 THEN time - previous_value END AS group_counts FROM windowedDF where Tool = '05M01' and stage = 178 and lot = 16924 and recipe = 300 order by time ASC\")\n\nsqlDF.limit(100).show","user":"admin","dateUpdated":"2018-10-09T13:32:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"sqlDF: org.apache.spark.sql.DataFrame = [Tool: string, stage: int ... 7 more fields]\n+-----+-----+-----+--------+------+-------+--------------+----------+------------+\n| Tool|stage|  Lot|  runnum|recipe|   time|previous_value|next_value|group_counts|\n+-----+-----+-----+--------+------+-------+--------------+----------+------------+\n|05M01|  178|16924|10557275|   300|4047836|             0|   4218768|        null|\n+-----+-----+-----+--------+------+-------+--------------+----------+------------+\n\n"}]},"apps":[],"jobName":"paragraph_1539091948698_2037636671","id":"20180928-165006_1899835410","dateCreated":"2018-10-09T13:32:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:42566"},{"text":"%spark2.spark\nval sqlDF = spark.sql(\"SELECT Tool, stage, Lot, runnum, recipe, time, previous_value, next_value, CASE WHEN previous_value > 0 THEN time - previous_value END AS group_counts FROM windowedDF where Tool = '05M01' and stage = 178 order by time ASC\")\nsqlDF.limit(100).show","user":"admin","dateUpdated":"2018-10-09T13:32:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"sqlDF: org.apache.spark.sql.DataFrame = [Tool: string, stage: int ... 7 more fields]\n+-----+-----+-----+--------+------+-------+--------------+----------+------------+\n| Tool|stage|  Lot|  runnum|recipe|   time|previous_value|next_value|group_counts|\n+-----+-----+-----+--------+------+-------+--------------+----------+------------+\n|05M01|  178|16924|10557275|   300|4047836|             0|   4218768|        null|\n|05M01|  178| 1344|10569030|   300|4218768|       4047836|   4271608|      170932|\n|05M01|  178|11873|10684973|   300|6197356|       4322052|  12626772|     1875304|\n+-----+-----+-----+--------+------+-------+--------------+----------+------------+\n\n"}]},"apps":[],"jobName":"paragraph_1539091948699_1878227627","id":"20180928-170432_1564668319","dateCreated":"2018-10-09T13:32:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:42567"},{"text":"%spark2.spark\n\nval matchedFaults = faultDF.select(\"time\", \"tool\").intersect( sensorDF.select(\"time\", \"tool\"))\n\nmatchedFaults.count\n","user":"admin","dateUpdated":"2018-10-09T13:32:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"matchedFaults: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [time: int, tool: string]\nres84: Long = 211\n"}]},"apps":[],"jobName":"paragraph_1539091948699_-342041629","id":"20180925-204909_1726486156","dateCreated":"2018-10-09T13:32:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:42568"},{"text":"%spark2.spark\ndf.count\n","user":"admin","dateUpdated":"2018-10-09T13:32:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res11: Long = 82189440\n"}]},"apps":[],"jobName":"paragraph_1539091948700_-169427180","id":"20180924-153428_1320828230","dateCreated":"2018-10-09T13:32:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:42569"},{"text":"%spark2.spark\nsendorDFWindowed.createOrReplaceTempView(\"sensor\")\n\nval sqlDF = spark.sql(\"SELECT Tool, stage, Lot, runnum, recipe, max(time)-min(time) as group_counts FROM sensor GROUP BY Tool, stage, Lot, runnum, recipe GROUPING SETS ((Tool, stage, Lot, runnum, recipe), (Tool, stage, Lot, runnum), (Tool, stage, Lot), (Tool, stage), (Tool)) ORDER BY Tool DESC NULLS LAST, stage ASC NULLS LAST, Lot ASC NULLS LAST, runnum ASC NULLS LAST, recipe ASC NULLS LAST\")\n\nsqlDF.limit(10).show\n\n\n//SELECT Tool, stage, Lot, runnum, recipe, max(time)-min(time) as group_counts\n//  FROM sensor\n//  GROUP BY Tool, stage, Lot, runnum, recipe\n//  GROUPING SETS ((Tool, stage, Lot, runnum, recipe), (Tool, stage, Lot, runnum), (Tool, stage, Lot), (Tool, stage), (Tool))\n//  ORDER BY Tool DESC NULLS LAST, stage ASC NULLS LAST, LotASC NULLS LAST, runnum ASC NULLS LAST, recipe ASC NULLS LAST, time ASC NULLS LAST","user":"admin","dateUpdated":"2018-10-09T13:32:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"sqlDF: org.apache.spark.sql.DataFrame = [Tool: string, stage: int ... 4 more fields]\n+-----+-----+---+--------+------+------------+\n| Tool|stage|Lot|  runnum|recipe|group_counts|\n+-----+-----+---+--------+------+------------+\n|10M02|    0| 27|11215862|   145|        4260|\n|10M02|    0| 27|11215862|  null|        4260|\n|10M02|    0| 27|    null|  null|        4260|\n|10M02|    0| 50|10753098|   145|        4204|\n|10M02|    0| 50|10753098|  null|        4204|\n|10M02|    0| 50|    null|  null|        4204|\n|10M02|    0|108|11678624|   145|        4316|\n|10M02|    0|108|11678624|  null|        4316|\n|10M02|    0|108|    null|  null|        4316|\n|10M02|    0|164|12186218|   145|        4304|\n+-----+-----+---+--------+------+------------+\n\n"}]},"apps":[],"jobName":"paragraph_1539091948700_1931436959","id":"20180926-165932_1935276543","dateCreated":"2018-10-09T13:32:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:42570"},{"text":"%spark2.spark\nval window1 = sensorDF.join(faultDFWindowed, sensorDF(\"Tool\") === faultDFWindowed(\"Tool\") && sensorDF(\"time\") >= faultDFWindowed(\"Lagger\")  && sensorDF(\"time\") <= faultDFWindowed(\"Leader\") , joinType=\"left_outer\")\n","user":"admin","dateUpdated":"2018-10-09T13:32:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1539091948701_-532293647","id":"20180925-212855_1768338850","dateCreated":"2018-10-09T13:32:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:42571"},{"text":"%spark2.spark\nval df1 = sensorDF.join(faultDF, sensorDF(\"Tool\") === faultDF(\"Tool\") && sensorDF(\"time\") = faultDF(\"time\")  , joinType=\"left_outer\").drop(faultDF(\"Tool\")).drop(faultDF(\"time\"))\ndf1.limit(10).sow\n\n\n","user":"admin","dateUpdated":"2018-10-09T13:32:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df1: org.apache.spark.sql.DataFrame = [time: int, Tool: string ... 23 more fields]\n+-------+-----+-----+----+--------+------+-----------+--------------------+-------------------+-------------------+---------------------+---------------------+-------------------+-------------------+-----------------------+-------------------+-----------------+--------------------+--------------------+----------------------+------------------+------------------+-------------------+------------------+----------+\n|   time| Tool|stage| Lot|  runnum|recipe|recipe_step|    IONGAUGEPRESSURE|    ETCHBEAMVOLTAGE|    ETCHBEAMCURRENT|ETCHSUPPRESSORVOLTAGE|ETCHSUPPRESSORCURRENT|   FLOWCOOLFLOWRATE|   FLOWCOOLPRESSURE|ETCHGASCHANNEL1READBACK| ETCHPBNGASREADBACK| FIXTURETILTANGLE|       ROTATIONSPEED| ACTUALROTATIONANGLE|FIXTURESHUTTERPOSITION|   ETCHSOURCEUSAGE|ETCHAUXSOURCETIMER|ETCHAUX2SOURCETIMER|ACTUALSTEPDURATION|fault_name|\n+-------+-----+-----+----+--------+------+-----------+--------------------+-------------------+-------------------+---------------------+---------------------+-------------------+-------------------+-----------------------+-------------------+-----------------+--------------------+--------------------+----------------------+------------------+------------------+-------------------+------------------+----------+\n|3283834|01M02|    1|9253|10511673|    67|        1.0|-0.07942834674260164|-0.9588144376728021|-0.9595093781327426|    -0.94619431001018|  -0.9390426794102577| -2.842906518897486|-2.3328068957350747|    -1.7516611485587419| -2.783162253978537|2.027847975076401|-0.01320718744649...|-0.12243707083890377|                   0.0|2.3953704185454097|2.8715106903677774| 3.1759407144678846|  4.03778468798202|      null|\n|3283838|01M02|    1|9253|10511673|    67|        1.0|-0.07941874349586524|-0.9589281863908988|-0.9596512376809438|  -0.9461026148437222|  -0.9390426794102577| -2.842906518897486|-2.3328068957350747|    -1.7439048724585284|-2.7808841494321865|2.027847975076401|-0.01320718744649...|-0.12243707083890377|                   0.0|2.3953704185454097|2.8715106903677774| 3.1759407144678846|  4.03778468798202|      null|\n|3283842|01M02|    1|9253|10511673|    67|        1.0|-0.07940864226851407|-0.9591556838270923|-0.9600059167857921|  -0.9460567672604933|  -0.9390426794102577| -2.841849516088073|-2.3328068957350747|    -1.7439048724585284|-2.7808841494321865|2.027847975076401|-0.01320718744649...|-0.12243707083890377|                   0.0|2.3953704185454097|2.8715106903677774| 3.1759407144678846|  4.03778468798202|      null|\n|3283846|01M02|    1|9253|10511673|    67|        1.0|-0.07941983490176263|-0.9589281863908988|-0.9592965888104408|   -0.946148462426951|  -0.9390426794102577| -2.841849516088073|-2.3328068957350747|    -1.7471575247996358|-2.7808841494321865|2.027847975076401|-0.01320718744649...|-0.12243707083890377|                   0.0|2.3953704185454097|2.8715106903677774| 3.1759407144678846|  4.03778468798202|      null|\n|3283850|01M02|    1|9253|10511673|    67|        1.0|-0.07943041568037194| -0.959269432545189| -0.959438448358642|  -0.9460567672604933|  -0.9390426794102577| -2.841849516088073|-2.3328068957350747|    -1.7471575247996358|-2.7843889043335626|2.027847975076401|-0.01320718744649...|-0.12243707083890377|                   0.0|2.3953704185454097|2.8715106903677774| 3.1759407144678846|  4.03778468798202|      null|\n|3283854|01M02|    1|9253|10511673|    67|        1.0|-0.07943041568037194|-0.9589850595615739|-0.9592256590363402|    -0.94619431001018|  -0.9390426794102577|-2.8391315113012996|-2.3328068957350747|    -1.7471575247996358|-2.7843889043335626|2.027847975076401|-0.01320718744649...|-0.12243707083890377|                   0.0|2.3953704185454097|2.8715106903677774| 3.1759407144678846|  4.03778468798202|      null|\n|3283858|01M02|    1|9253|10511673|    67|        1.0|-0.07944041797117714|-0.9589850595615739|-0.9588710101658371|   -0.946148462426951|  -0.9390426794102577|-2.8391315113012996|-2.3328068957350747|    -1.7424036796167208|-2.7843889043335626|2.027847975076401|-0.01320718744649...|-0.12243707083890377|                   0.0|2.3953704185454097|2.8715106903677774| 3.1759407144678846|  4.03778468798202|      null|\n|3283862|01M02|    1|9253|10511673|    67|        1.0|-0.07944041797117714|-0.9588713132202237|-0.9586582208435352|   -0.946286002288601|  -0.9390426794102577| -2.837168490971736|-2.3328068957350747|    -1.7424036796167208| -2.783162253978537|2.027847975076401|-0.01320718744649...|-0.12243707083890377|                   0.0|2.3953704185454097|2.8715106903677774| 3.1759407144678846|  4.03778468798202|      null|\n|3283866|01M02|    1|9253|10511673|    67|        1.0|-0.07944987358906748|-0.9585869402366086|-0.9590837994881389|  -0.9463776974550588|  -0.9390426794102577| -2.837168490971736|-2.3328068957350747|    -1.7471575247996358| -2.783162253978537|2.027847975076401|-0.01320718744649...|-0.12243707083890377|                   0.0|2.3953704185454097|2.8715106903677774| 3.1759407144678846|  4.03778468798202|      null|\n|3283870|01M02|    1|9253|10511673|    67|        1.0|-0.07944987358906748|-0.9588144376728021| -0.959438448358642|  -0.9463776974550588|  -0.9390426794102577| -2.837168490971736|-2.3328068957350747|    -1.7471575247996358|-2.7866670088799133|2.027847975076401|-0.01320718744649...|-0.12243707083890377|                   0.0|2.3953704185454097|2.8715106903677774| 3.1759407144678846|  4.03778468798202|      null|\n+-------+-----+-----+----+--------+------+-----------+--------------------+-------------------+-------------------+---------------------+---------------------+-------------------+-------------------+-----------------------+-------------------+-----------------+--------------------+--------------------+----------------------+------------------+------------------+-------------------+------------------+----------+\n\n"}]},"apps":[],"jobName":"paragraph_1539091948701_-1413555973","id":"20180924-155453_195671230","dateCreated":"2018-10-09T13:32:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:42572"},{"text":"%spark2.spark\nval df1 = sensorDF.join(faultDF, sensorDF(\"Tool\") === faultDF(\"Tool\")\n    && sensorDF(\"time\").between(faultDF(\"time\"), $\"inter.end_ts\")\n    , joinType=\"left_outer\")\n","user":"admin","dateUpdated":"2018-10-09T13:32:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res37: Long = 82189444\n"}]},"apps":[],"jobName":"paragraph_1539091948701_517288055","id":"20180924-155926_581966991","dateCreated":"2018-10-09T13:32:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:42573"},{"text":"%spark2.spark\nfaultDF.show","user":"admin","dateUpdated":"2018-10-09T13:32:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+--------------------+-----+\n|   time|          fault_name| Tool|\n+-------+--------------------+-----+\n|3326152|FlowCool Pressure...|03M02|\n|3780688|FlowCool Pressure...|03M02|\n|3961378|FlowCool Pressure...|03M02|\n|4528896|FlowCool Pressure...|03M02|\n|4528896|FlowCool Pressure...|03M02|\n|4984318|Flowcool Pressure...|03M02|\n|4984318|Flowcool Pressure...|03M02|\n|5076390|FlowCool Pressure...|03M02|\n|5076390|FlowCool Pressure...|03M02|\n|5120600|FlowCool Pressure...|03M02|\n|5120600|FlowCool Pressure...|03M02|\n|5128078|Flowcool Pressure...|03M02|\n|5128078|Flowcool Pressure...|03M02|\n|6040840|Flowcool Pressure...|03M02|\n|6052526|FlowCool Pressure...|03M02|\n|6187286|FlowCool Pressure...|03M02|\n|6208070|FlowCool Pressure...|03M02|\n|6239880|FlowCool Pressure...|03M02|\n|6623116|FlowCool Pressure...|03M02|\n|6672860|FlowCool Pressure...|03M02|\n+-------+--------------------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1539091948702_1029540073","id":"20180924-203446_318055884","dateCreated":"2018-10-09T13:32:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:42574"},{"text":"%spark2.spark\n%spark2.spark\nval w = Window.partitionBy(\"tool\").orderBy(\"time\")\n\nval lagCol = lag(col(\"time\"), 1).over(w)\n\nval leadCol = lead(col(\"time\"), 1).over(w)\nval faultDFWindowed = faultDF.withColumn(\"Lagger\", lagCol).withColumn(\"Leader\", leadCol).na.fill(1)\n\nfaultDFWindowed.printSchema\n\nfaultDFWindowed.limit(10).show()","user":"admin","dateUpdated":"2018-10-09T13:32:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1539091948702_-2097084893","id":"20180925-210517_2055055356","dateCreated":"2018-10-09T13:32:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:42575"},{"text":"%spark2.spark\nval df1 = sensorDF.join(faultDFWindowed, sensorDF(\"Tool\") === faultDFWindowed(\"Tool\") && sensorDF(\"time\") >= faultDFWindowed(\"Lagger\")  && sensorDF(\"time\") <= faultDFWindowed(\"Leader\") , joinType=\"left_outer\")\ndf1.limit(10).show\n","user":"admin","dateUpdated":"2018-10-09T13:32:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df1: org.apache.spark.sql.DataFrame = [time: int, Tool: string ... 27 more fields]\n+--------+-----+-----+---+--------+------+-----------+------------------+------------------+------------------+---------------------+---------------------+------------------+------------------+-----------------------+------------------+-------------------+--------------------+-------------------+----------------------+-------------------+------------------+-------------------+-------------------+--------+--------------------+-----+--------+--------+\n|    time| Tool|stage|Lot|  runnum|recipe|recipe_step|  IONGAUGEPRESSURE|   ETCHBEAMVOLTAGE|   ETCHBEAMCURRENT|ETCHSUPPRESSORVOLTAGE|ETCHSUPPRESSORCURRENT|  FLOWCOOLFLOWRATE|  FLOWCOOLPRESSURE|ETCHGASCHANNEL1READBACK|ETCHPBNGASREADBACK|   FIXTURETILTANGLE|       ROTATIONSPEED|ACTUALROTATIONANGLE|FIXTURESHUTTERPOSITION|    ETCHSOURCEUSAGE|ETCHAUXSOURCETIMER|ETCHAUX2SOURCETIMER| ACTUALSTEPDURATION|    time|          fault_name| Tool|  Lagger|  Leader|\n+--------+-----+-----+---+--------+------+-----------+------------------+------------------+------------------+---------------------+---------------------+------------------+------------------+-----------------------+------------------+-------------------+--------------------+-------------------+----------------------+-------------------+------------------+-------------------+-------------------+--------+--------------------+-----+--------+--------+\n|21659388|01M01|    1|708|11716311|     1|        1.0|0.9552405922624904|1.0847422933780586|0.9606309949351034|  0.49624012992240263|   1.0384665919989637|0.6866313490327772|0.3670378103365176|      0.844287613829785|0.7364663252437856|-0.6723366844253791|-0.20389165787325159|-0.1524952203343316|                   0.0|-0.5720862490930253|1.3144904589040933| 0.2826559168503225|-0.6210821310923813|26098948|Flowcool Pressure...|01M01|20174938|31212736|\n|21659388|01M01|    1|708|11716311|     1|        1.0|0.9552405922624904|1.0847422933780586|0.9606309949351034|  0.49624012992240263|   1.0384665919989637|0.6866313490327772|0.3670378103365176|      0.844287613829785|0.7364663252437856|-0.6723366844253791|-0.20389165787325159|-0.1524952203343316|                   0.0|-0.5720862490930253|1.3144904589040933| 0.2826559168503225|-0.6210821310923813|20174938|       Flowcool leak|01M01|18573644|26098948|\n|21659392|01M01|    1|708|11716311|     1|        1.0|0.9552405922624904|1.0842901129986002|0.9758338277859906|  0.49619113354362576|   1.0624319617138736|0.6866313490327772|0.3654098945931409|      0.845498060781726|0.7364663252437856|-0.6723366844253791|-0.20389165787325159|-0.1524952203343316|                   0.0|-0.5720808835719328|1.3144949458041868| 0.2826639981016589|-0.6210821310923813|26098948|Flowcool Pressure...|01M01|20174938|31212736|\n|21659392|01M01|    1|708|11716311|     1|        1.0|0.9552405922624904|1.0842901129986002|0.9758338277859906|  0.49619113354362576|   1.0624319617138736|0.6866313490327772|0.3654098945931409|      0.845498060781726|0.7364663252437856|-0.6723366844253791|-0.20389165787325159|-0.1524952203343316|                   0.0|-0.5720808835719328|1.3144949458041868| 0.2826639981016589|-0.6210821310923813|20174938|       Flowcool leak|01M01|18573644|26098948|\n|21659396|01M01|    1|708|11716311|     1|        1.0|0.9552405922624904|1.0843660034119362|0.9985358416832328|   0.4962891263011799|    1.101504260834474|0.6882665202762506|0.3670378103365176|      0.845498060781726| 0.734228546228171|-0.6723366844253791|-0.20389165787325159|-0.1524952203343316|                   0.0|-0.5720755180508402|1.3144994327042805| 0.2826720793529952|-0.6210821310923813|26098948|Flowcool Pressure...|01M01|20174938|31212736|\n|21659396|01M01|    1|708|11716311|     1|        1.0|0.9552405922624904|1.0843660034119362|0.9985358416832328|   0.4962891263011799|    1.101504260834474|0.6882665202762506|0.3670378103365176|      0.845498060781726| 0.734228546228171|-0.6723366844253791|-0.20389165787325159|-0.1524952203343316|                   0.0|-0.5720755180508402|1.3144994327042805| 0.2826720793529952|-0.6210821310923813|20174938|       Flowcool leak|01M01|18573644|26098948|\n|21659400|01M01|    1|708|11716311|     1|        1.0|0.9552405922624904|1.0854948733103038| 1.020019670640917|   0.4959982103021913|   1.1379456171776132|0.6882665202762506|0.3670378103365176|      0.845498060781726| 0.734228546228171|-0.6723366844253791|-0.20389165787325159|-0.1524952203343316|                   0.0|-0.5720701525297477| 1.314503919604374| 0.2826801606043316|-0.6210821310923813|26098948|Flowcool Pressure...|01M01|20174938|31212736|\n|21659400|01M01|    1|708|11716311|     1|        1.0|0.9552405922624904|1.0854948733103038| 1.020019670640917|   0.4959982103021913|   1.1379456171776132|0.6882665202762506|0.3670378103365176|      0.845498060781726| 0.734228546228171|-0.6723366844253791|-0.20389165787325159|-0.1524952203343316|                   0.0|-0.5720701525297477| 1.314503919604374| 0.2826801606043316|-0.6210821310923813|20174938|       Flowcool leak|01M01|18573644|26098948|\n|21659404|01M01|    1|708|11716311|     1|        1.0|0.9552405922624904|1.0843660034119362|1.0358963930328355|   0.4958512211658603|   1.1665081395648431|0.6938033522954546|0.3670378103365176|     0.8420239208287525|0.7358430041127109|-0.6723366844253791|-0.20389165787325159|-0.1524952203343316|                   0.0|-0.5720647870086552|1.3145084065044674|  0.282688241855668|-0.6210821310923813|26098948|Flowcool Pressure...|01M01|20174938|31212736|\n|21659404|01M01|    1|708|11716311|     1|        1.0|0.9552405922624904|1.0843660034119362|1.0358963930328355|   0.4958512211658603|   1.1665081395648431|0.6938033522954546|0.3670378103365176|     0.8420239208287525|0.7358430041127109|-0.6723366844253791|-0.20389165787325159|-0.1524952203343316|                   0.0|-0.5720647870086552|1.3145084065044674|  0.282688241855668|-0.6210821310923813|20174938|       Flowcool leak|01M01|18573644|26098948|\n+--------+-----+-----+---+--------+------+-----------+------------------+------------------+------------------+---------------------+---------------------+------------------+------------------+-----------------------+------------------+-------------------+--------------------+-------------------+----------------------+-------------------+------------------+-------------------+-------------------+--------+--------------------+-----+--------+--------+\n\n"}]},"apps":[],"jobName":"paragraph_1539091948703_-1839739565","id":"20180924-204957_694000825","dateCreated":"2018-10-09T13:32:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:42576"},{"text":"%spark2.spark\n","user":"admin","dateUpdated":"2018-10-09T13:32:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1539091948703_521342449","id":"20180924-210952_851439448","dateCreated":"2018-10-09T13:32:28+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:42577"}],"name":"PHM Data Challenge","id":"2DTJE38PP","noteParams":{},"noteForms":{},"angularObjects":{"sh:shared_process":[],"spark2:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}